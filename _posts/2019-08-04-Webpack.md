---
layout: post
title:  "Webpack (v4)"
categories: Webpack
---

- Webpack only understands JavaScript (any code other than import and export statements.) and JSON files. 
    - **(Loaders)** allow webpack to process **(Transform)** other types of files and convert them into valid modules that can be consumed by your application and added to the dependency graph.
        - The test property identifies which file or files should be transformed.
        - The use property indicates which loader should be used to do the transforming.
            - When using other ES2015 features, make sure to use a transpiler such as Babel or Bubl√©.
    - **(Plugins)** can be leveraged to perform a wider range of tasks like;
        - bundle optimization, 
        - asset management and, 
        - injection of environment variables.
        - In order to use a plugin, you need to require() it and add it to the plugins array.
    - **(Mode)** can enable webpack's built-in optimizations that correspond to each environment. 

### Asset Management
- Prior to webpack, front-end developers would use tools like grunt and gulp to process these assets and move them from their /src folder into their /dist or /build directory.
    - Webpack will dynamically bundle all dependencies (creating what's known as a dependency graph).  
    - The file and url loaders will take any file you load through them and output it to your build directory.

### Code Split
- There are three general approaches to code splitting available:
    - Entry Points: Manually split code using entry configuration.
    - Prevent Duplication: Use the SplitChunksPlugin to dedupe and split chunks.
    - Dynamic Imports: Split code via inline function calls within modules.


### Source Map
Source maps, which map your compiled code back to your original source code. If an error originates from b.js, the source map will tell you exactly that.
    - devtool: 'inline-source-map'
## Steps Setup
```
    $ npm install webpack --save-dev
    $ npm install webpack-cli --save-dev
```

## Webpack Config with single out directory
```javascript
    const HtmlWebpackPlugin = require('html-webpack-plugin'); //installed via npm
    const webpack = require('webpack'); //to access built-in plugins
    const path = require('path');
    const { CleanWebpackPlugin } = require('clean-webpack-plugin');

    module.exports = {
        mode: 'production',
        // "production" | "development" | "none"

        entry: './path/to/my/entry/file.js',
        // string | object | array
        // defaults to ./src

        output: {
            path: path.resolve(__dirname, 'dist'),
            // must be an absolute path (use the Node.js path module)
            filename: 'my-first-webpack.bundle.js'
        },
        module: {
            rules: [
                { 
                    test: /\.txt$/, 
                    include: [
                        path.resolve(__dirname, "app")
                    ], // optional
                    exclude: [
                        path.resolve(__dirname, "app/demo-files")
                    ], // optional
                    // Use arrays of absolute paths in include and exclude
                    use: 'raw-loader' 
                },
                {
                    test: /\.css$/,
                    use: [
                        'style-loader',
                       'css-loader'
                    ]
                },
                {
                    test: /\.(png|svg|jpg|gif)$/,
                    use: [
                        'file-loader'
                    ]
                },
                // OR file-loader for other types of file.
                {
                    test: /\.(woff|woff2|eot|ttf|otf)$/,
                    use: [
                        'file-loader'
                    ]
                },
                // Loading Data, CSVs, TSVs, and XML.
                {
                    test: /\.(csv|tsv)$/,
                    use: [
                        'csv-loader'
                    ]
                },
                {
                    test: /\.xml$/,
                    use: [
                        'xml-loader'
                    ]
                }
            ]
        },
        plugins: [
            new CleanWebpackPlugin(),
            new HtmlWebpackPlugin({template: './src/index.html'})
        ]
    };
```

## Webpack configure for dynamically generate bundle names, based on the entry point names
```javascript
    const path = require('path');
    const { CleanWebpackPlugin } = require('clean-webpack-plugin');

    module.exports = {
        entry: {
            app: './src/index.js',
            print: './src/print.js'
        },
        plugins: [
            new CleanWebpackPlugin(),
        ]
        output: {
            filename: '[name].bundle.js',
            path: path.resolve(__dirname, 'dist')
        }
    };
```

## Webpack for TypeScript
```javascript
    const path = require('path');

    module.exports = {
    entry: './src/index.ts',
    module: {
        rules: [
        {
            test: /\.tsx?$/,
            use: 'ts-loader',
            exclude: /node_modules/
        }
        ]
    },
    resolve: {
        extensions: [ '.tsx', '.ts', '.js' ]
        // extensions that are used
    },
    output: {
        filename: 'bundle.js',
        path: path.resolve(__dirname, 'dist')
    }
    };
```